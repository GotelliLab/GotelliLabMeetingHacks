---
title: "Archetype ggplot Graphs"
author: "Nick Gotelli"
date: "December 22, 2018"
output: 
  html_document: 
    number_sections: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This file condenses and simplifies a terrific set of graphs originally posted at:
http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html#top 

To make the examples self-contained, all library calls occur within each example

# Correlation

## Simple scatterplot

```{r}
# Scatterplot

library(ggplot2)

scatter1 <- ggplot(mpg, aes(x=cty, y=hwy)) +
  geom_point(aes(col=cyl,size=displ)) +
  geom_smooth(method="loess",se=FALSE,col="red") +  
  xlim(c(0, 40)) + 
  ylim(c(0, 50)) + 
  labs(subtitle="Highway vs City Mileage", 
       y="City Mileage (mpg)", 
       x="Highway Mileage (mpg)", 
       title="Scatterplot", 
       caption = "Source: R-data") +
  theme_bw() 
  

plot(scatter1)

```

## Scatterplot with encircling

```{r}

# Scatterplot with encircling
# devtools::install_github("hrbrmstr/ggalt")
library(ggplot2)
library(ggalt)

mpgGrp <- mpg[mpg$class=="compact",] # create a subset data frame for encircling

scatter2 <- ggplot(mpg, aes(x=cty, y=hwy)) +
  geom_point(aes(col=cyl,size=displ)) +
  geom_smooth(method="loess",se=FALSE,col="red") +  
  xlim(c(0, 40)) + 
  ylim(c(0, 50)) + 
  labs(subtitle="Highway vs City Mileage", 
       y="City Mileage (mpg)", 
       x="Highway Mileage (mpg)", 
       title="Scatterplot with encircling", 
       caption = "Source: R-data") +
  theme_bw() +
  
  geom_encircle(data=mpgGrp,
                aes(x=cty,y=hwy),
                     color="seagreen",
                     size=3,
                     expand=0.08)

plot(scatter2)


```

## Jitter plot
```{r}
# Jitter plot

library(ggplot2)

scatter3 <- ggplot(mpg, aes(x=cty, y=hwy)) +
  geom_jitter(width=1, height=1, size=1) +
              # aes(col=cyl,size=displ)) +
  geom_smooth(method="loess",se=FALSE,col="red") +  
  xlim(c(0, 40)) + 
  ylim(c(0, 50)) + 
  labs(subtitle="Highway vs City Mileage", 
       y="City Mileage (mpg)", 
       x="Highway Mileage (mpg)", 
       title="Scatterplot with jittering", 
       caption = "Source: R-data") +
  theme_bw() 
  

plot(scatter3)

```

## Counts chart

```{r}
library(ggplot2)

scatter4 <- ggplot(mpg, aes(x=cty, y=hwy)) +
  geom_count(col="goldenrod",show.legend=TRUE) +
              # aes(col=cyl,size=displ)) +
  geom_smooth(method="loess",se=FALSE,col="red") +  
  xlim(c(0, 40)) + 
  ylim(c(0, 50)) + 
  labs(subtitle="Highway vs City Mileage", 
       y="City Mileage (mpg)", 
       x="Highway Mileage (mpg)", 
       title="Scatterplot with count overlay", 
       caption = "Source: R-data") +
  theme_bw() 
  

plot(scatter4)


```


## Bubble plot

```{r}
library(ggplot2)

mpg_select <- mpg[mpg$manufacturer %in% c("audi", "ford", "honda", "hyundai"), ]

scatter5 <- ggplot(mpg_select, aes(x=displ, y=cty)) +
  geom_smooth(aes(col=manufacturer),method="lm",se=FALSE) +  
  geom_jitter(aes(col=manufacturer,size=hwy)) +
  labs(subtitle="Highway Mileage vs Displacement", 
       y="City Mileage (mpg)", 
       x="Highway Mileage (mpg)", 
       title="Bubble plot with highway as point size", 
       caption = "Source: R-data") +
  theme_bw() 
  

plot(scatter5)
```

## Scatter plot with marginal distributions

```{r}
library(ggplot2)
library(ggExtra)
xVar <- rnorm(300)
yVar <- xVar + 0.5*rnorm(300)
sData <- data.frame(xVar,yVar)

scatter6 <- ggplot(sData,aes(x=xVar,y=yVar)) +
  geom_point() + 
  geom_smooth(method="lm",se=FALSE) +
  theme_bw()  

ggMarginal(p=scatter6, type = "histogram", fill="thistle")
# ggMarginal(p=scatter6, type = "boxplot", fill="khaki")
# ggMarginal(p=scatter6, type = "density", fill="tomato")
# ggMarginal(p=scatter6, type = "violin", fill="wheat")



  
```

## Correlogram

```{r}
# devtools::install_github("kassambara/ggcorrplot")
library(ggplot2)
library(ggcorrplot)

# Correlation matrix
data(mtcars)
corr <- round(cor(mtcars), 1)

# Plot
ggcorrplot(corr, hc.order = TRUE, 
           type = "lower", 
           lab = TRUE, 
           lab_size = 3, 
           method="circle", 
           colors = c("tomato2", "white", "springgreen3"), 
           title="Correlogram of mtcars", 
           ggtheme=theme_bw)
```

